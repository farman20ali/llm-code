{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "What areas have the highest number of accidents?"}, {"role": "assistant", "content": "```sql\nSELECT accident_location, COUNT(*) AS num_accidents\nFROM public.accident_reports\nGROUP BY accident_location\nORDER BY num_accidents DESC;\n```\n\nQuery 2:\n```sql\nSELECT *\nFROM public.accident_reports\nWHERE weather_condition = (SELECT id FROM weather_condition WHERE condition = 'Rain');\n```\n\nQuery 3:\n```sql\nSELECT at.label AS accident_type, COUNT(*) AS num_accidents\nFROM public.accident_reports ar\nJOIN public.accident_types at ON ar.accident_type_id = at.id\nWHERE ar.accident_location ILIKE '%Islamabad%'\nGROUP BY at.label;\n```\n\nQuery 4:\n```sql\nSELECT at.label AS accident_type, COUNT(*) AS num_accidents\nFROM public.accident_reports ar\nJOIN public.accident_types at ON ar.accident_type_id = at.id\nWHERE ar.accident_location ILIKE '%Islamabad%'\nGROUP BY at.label;\n```\n\nQuery 5:\n```sql\nSELECT *\nFROM dispatch\nWHERE drop_time - pickup_time > interval '30 minutes';\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Could you show accidents that occurred during rainy weather?"}, {"role": "assistant", "content": "```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at, wt.condition AS weather_condition\nFROM public.accident_reports ar\nJOIN weather_condition wt ON ar.weather_condition = wt.id\nWHERE wt.condition = 'Rain';\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "I need to count the number of accidents by type in islamabad"}, {"role": "assistant", "content": "SELECT at.label AS accident_type, COUNT(ar.report_id) AS accident_count\nFROM public.accident_reports ar\nJOIN public.accident_types at ON ar.accident_type_id = at.id\nWHERE ar.accident_location ILIKE '%islamabad%'\nGROUP BY at.label;"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Count the number of accidents by type in Islamabad"}, {"role": "assistant", "content": "SELECT at.label AS accident_type, COUNT(ar.report_id) AS total_accidents\nFROM public.accident_reports ar\nJOIN public.accident_types at ON ar.accident_type_id = at.id\nWHERE ar.accident_location ILIKE '%Islamabad%'\nGROUP BY at.label;"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "List all dispatches that took more than 30 minutes"}, {"role": "assistant", "content": "```sql\nSELECT *\nFROM dispatch\nWHERE drop_time - pickup_time > INTERVAL '30 minutes';\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "I need to show accidents on highways with poor visibility"}, {"role": "assistant", "content": "```sql\nSELECT *\nFROM public.accident_reports ar\nJOIN road_type rt ON ar.road_type = rt.id\nJOIN visibility v ON ar.visibility = v.id\nWHERE rt.type = 'Highway' AND v.level = 'Poor';\n```\n\nQuery 2:\n```sql\nSELECT *\nFROM public.accident_reports\nWHERE num_affecties > 3;\n```\n\nQuery 3:\n```sql\nSELECT *\nFROM public.accident_reports ar\nJOIN road_type rt ON ar.road_type = rt.id\nJOIN visibility v ON ar.visibility = v.id\nWHERE rt.type = 'Highway' AND v.level = 'Poor';\n```\n\nQuery 4:\n```sql\nSELECT *\nFROM public.accident_reports ar\nJOIN weather_condition wc ON ar.weather_condition = wc.id\nWHERE wc.condition = 'Rain';\n```\n\nQuery 5:\n```sql\nSELECT *\nFROM public.accident_reports ar\nJOIN dispatch d ON ar.report_id = d.report_id;\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Could you find accidents with more than 3 casualties?"}, {"role": "assistant", "content": "```sql\nSELECT *\nFROM public.accident_reports\nWHERE num_affecties > 3;\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Could you show accidents on highways with poor visibility?"}, {"role": "assistant", "content": "SELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN road_type rt ON ar.road_type = rt.id\nJOIN visibility v ON ar.visibility = v.id\nWHERE rt.type = 'Highway' AND v.level = 'Poor';"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "List accidents that occurred during rainy weather"}, {"role": "assistant", "content": "SELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN weather_condition wc ON ar.weather_condition = wc.id\nWHERE wc.condition = 'Rain';"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "List all accidents where ambulances were dispatched"}, {"role": "assistant", "content": "SELECT ar.report_id, ar.accident_location, ar.created_at, ar.status, d.pickup_time, d.drop_time, o.label AS hospital_name\nFROM public.accident_reports ar\nJOIN dispatch d ON ar.report_id = d.report_id\nJOIN organizations o ON d.hospital_id = o.id;"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Could you list all accidents where ambulances were dispatched?"}, {"role": "assistant", "content": "```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at, o.label AS ambulance_organization\nFROM public.accident_reports ar\nJOIN dispatch d ON ar.report_id = d.report_id\nJOIN organizations o ON d.hospital_id = o.id\nWHERE d.ambulance_id IS NOT NULL;\n```\n\nQuery 2:\n```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN public.vehicle_involved v ON ar.vehicle_involved_id = v.id\nWHERE v.label = 'Pedestrian';\n```\n\nQuery 3:\n```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN weather_condition wc ON ar.weather_condition = wc.id\nWHERE wc.condition = 'Rain';\n```\n\nQuery 4:\n```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at, o.label AS hospital_name\nFROM public.accident_reports ar\nJOIN dispatch d ON ar.report_id = d.report_id\nJOIN organizations o ON d.hospital_id = o.id\nWHERE d.drop_time >= CURRENT_DATE - INTERVAL '7 days';\n```\n\nQuery 5:\n```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN road_type rt ON ar.road_type = rt.id\nJOIN visibility v ON ar.visibility = v.id\nWHERE rt.type = 'Highway' AND v.level = 'Poor';\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "List all accidents involving pedestrians"}, {"role": "assistant", "content": "SELECT ar.report_id, ar.accident_location, ar.created_at, ar.status, at.label AS accident_type\nFROM public.accident_reports ar\nJOIN public.accident_types at ON ar.accident_type_id = at.id\nWHERE ar.patient_victim_id = (SELECT id FROM public.patient_victim WHERE label = 'Pedestrian');"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Show accidents that occurred during rainy weather"}, {"role": "assistant", "content": "```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at, wt.condition AS weather_condition\nFROM public.accident_reports ar\nJOIN weather_condition wt ON ar.weather_condition = wt.id\nWHERE wt.condition = 'Rain';\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Show accidents with hospital transfers in the last week"}, {"role": "assistant", "content": "```sql\nSELECT ar.report_id, ar.accident_location, ar.created_at, o.label AS hospital_transferred_to\nFROM public.accident_reports ar\nJOIN dispatch d ON ar.report_id = d.report_id\nJOIN organizations o ON d.hospital_id = o.id\nWHERE d.drop_time >= CURRENT_DATE - INTERVAL '1 week'\n```"}]}
{"messages": [{"role": "system", "content": "You are a PostgreSQL SQL assistant for a traffic accident reporting system. Generate specific and optimized SQL SELECT statements based on user questions. Always include relevant WHERE clauses, JOINs, and aggregations as needed. Never use SELECT * unless specifically requested. Use correct table and column names from the schema. Do not include explanations or comments."}, {"role": "user", "content": "Show accidents on highways with poor visibility"}, {"role": "assistant", "content": "SELECT ar.report_id, ar.accident_location, ar.created_at\nFROM public.accident_reports ar\nJOIN road_type rt ON ar.road_type = rt.id\nJOIN visibility v ON ar.visibility = v.id\nWHERE rt.type = 'Highway' AND v.level = 'Poor';"}]}
